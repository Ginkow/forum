<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forum</title>
    <link rel="stylesheet" href="/static/main_page.css">
</head>
<body>

<header>
    <h1>EFsport</h1>
    <h2>
        <div class="dropdown">
            {{if .IsLoggedIn}}
                <img src="/images/{{.ProfilePicture}}" alt="Photo de profil" class="profile-picture" id="profile-picture">
                <!-- Formulaire d'upload d'image (initiallement caché) -->
                <form id="upload-form" style="display: none;" action="/uploadProfilePicture" method="post" enctype="multipart/form-data">
                    <input type="file" name="profilePicture" id="profile-picture-input">
                    <input type="submit" value="Upload" id="upload-button">
                </form>
            {{else}}
                <button>
                    <a href="http://localhost:6969/login" method="GET">Se Connecter/S'inscrire</a>
                </button>
            {{end}}
        </div>
        <div class="container_post">
            <button>
                <a href="http://localhost:6969/newpost" method="GET">+</a>
            </button>
        </div>
    </h2>
</header>

<section>
    <p>Derniers sujets à la une</p>
    {{range .Posts}}
    <div>
        <h2>{{.Title}}</h2>
        <p>{{.Content}}</p>
        {{if .Video}}
        <video width="320" height="240" controls>
            <source src="/{{.Video}}" type="video/mp4">
            Votre navigateur ne supporte pas la balise vidéo.
        </video>
        {{end}}
    </div>
    <hr>
    {{end}}
</section>

<!-- JavaScript pour gérer le clic sur la photo de profil -->
<script>
    document.getElementById("profile-picture").addEventListener("click", function() {
        // Afficher le formulaire d'upload d'image
        document.getElementById("upload-form").style.display = "block";
    });

    // JavaScript pour afficher le nom du fichier sélectionné
    document.getElementById("profile-picture-input").addEventListener("change", function() {
        var fileName = this.files[0].name;
        document.getElementById("upload-button").value = "Upload " + fileName;
    });
</script>

</body>
</html>
